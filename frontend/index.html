<!DOCTYPE html>
<html lang="pt">
<head>

  <meta charset="UTF-8">
  <title>Ouviescrevi ‚Äì Conversor Inteligente</title>
  <meta name="description" content="Converte ficheiros com IA. Word para PDF, imagens para PDF, e muito mais!">
  <meta name="keywords" content="converter Word para PDF, PDF para texto, imagem para PDF, conversor de ficheiros online, transcri√ß√£o de √°udio, transcri√ß√£o autom√°tica, Ouviescrevi">

  <meta name="robots" content="index, follow">
  <link rel="icon" href="/logos/ouviescreviicon.png" type="image/png">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>

  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #A550F7, #00C3FF);
      color: white;
      text-align: center;
    }
    header {
      padding: 20px;
    }
    header img {
      height: 80px;
      margin-bottom: 10px;
    }
    h1 {
      font-size: 2.5em;
      margin: 10px 0;
    }
    p.sub {
      font-size: 1.2em;
      margin-top: 0;
    }
    .btn-main {
      background-color: white;
      color: #333;
      font-weight: bold;
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      cursor: pointer;
      transition: 0.3s;
    }
    .btn-main:hover {
      background-color: #f1f1f1;
    }
    .features {
      background: white;
      color: #333;
      margin-top: 60px;
      padding: 40px 20px;
      border-radius: 30px 30px 0 0;
    }
    .features h2 {
      margin-top: 0;
    }
    .features ul {
      list-style: none;
      padding: 0;
      font-size: 1.1em;
      line-height: 2em;
    }
    footer {
      margin-top: 60px;
      padding: 20px;
      font-size: 0.9em;
      color: #eee;
    }
    .converter {
      background: white;
      color: #333;
      margin: 60px auto;
      max-width: 700px;
      padding: 40px;
      border-radius: 20px;
    }
    select, input[type="file"] {
      padding: 10px;
      margin-top: 20px;
      font-size: 1em;
    }
    #status {
      margin-top: 20px;
      color: #333;
    }
  </style>
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "Ouviescrevi",
  "url": "https://ouviescrevi.pt/",
  "applicationCategory": "Utility",
  "operatingSystem": "All",
  "description": "Converte ficheiros online com IA. Word para PDF, imagem para PDF, extrair texto de PDFs e muito mais!",
  "keywords": ["conversor de ficheiros", "converter Word para PDF", "imagem para PDF", "extrair texto de PDF", "transcri√ß√£o autom√°tica"]
}
</script>

</head>
<body>

  <header>
    <img src="/logos/ouviescrevimainlogo.png" alt="Ouviescrevi">
    <h1>Ouviescrevi ‚Äì Convers√µes Inteligentes</h1>
    <p class="sub">Experimenta gratuitamente as ferramentas de convers√£o</p>
  </header>

  <section class="features">
    <h2>üîß Funcionalidades em breve</h2>
    <ul>
      <li>üîç Pesquisa inteligente nas transcri√ß√µes</li>
      <li>üó£Ô∏è Tradu√ß√£o autom√°tica para outros idiomas</li>
      <li>üìÖ Hist√≥rico de transcri√ß√µes por utilizador</li>
      <li>üìÇ Envio de ficheiros maiores</li>
      <li>üß† Sumariza√ß√£o e an√°lise com IA</li>
    </ul>
    <p style="margin-top: 20px; font-style: italic;">Fica atento ‚Äì estamos s√≥ a come√ßar!</p>
  </section>

  <section class="converter">
    <h2>üìÅ Conversor de Ficheiros</h2>
    <p>Escolhe o tipo de convers√£o que queres fazer:</p>
    <select id="conversionType" onchange="updateInput()">
      <option value="word2pdf">Word (.docx) ‚Üí PDF</option>
       <option value="pdf2text">PDF ‚Üí Texto (.txt)</option>
  <option value="img2pdf">Imagem (.jpg/.png) ‚Üí PDF</option>
  <option value="pdf2word">PDF ‚Üí Word (.docx)</option>
  <option value="img2text" disabled>Imagem ‚Üí Texto (em breve)</option>
    </select>

    <div id="uploadArea">
      <input type="file" id="wordInput" accept=".doc,.docx">
      <br>
      <button onclick="convertWord()" class="btn-main">Converter e Descarregar</button>
      <p id="wordStatus"></p>
    </div>
  </section>

  <footer>
    ¬© 2025 Ouviescrevi ¬∑ Todos os direitos reservados
  </footer>

  <!-- Scripts -->
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
  function updateInput() {
    const type = document.getElementById("conversionType").value;
    const area = document.getElementById("uploadArea");

    if (type === "word2pdf") {
      area.innerHTML = `
        <input type="file" id="wordInput" accept=".doc,.docx">
        <br>
        <button onclick="convertWord()" class="btn-main">Converter e Descarregar</button>
        <p id="wordStatus"></p>
      `;
    }

    else if (type === "pdf2text") {
      area.innerHTML = `
        <input type="file" id="pdfInput" accept=".pdf">
        <br>
        <button onclick="convertPDFtoText()" class="btn-main">Extrair Texto</button>
        <p id="wordStatus"></p>
      `;
    }

    else if (type === "img2pdf") {
      area.innerHTML = `
        <input type="file" id="imgInput" accept="image/png, image/jpeg">
        <br>
        <button onclick="convertImageToPDF()" class="btn-main">Converter Imagem</button>
        <p id="wordStatus"></p>
      `;
    }

    else if (type === "pdf2word") {
      area.innerHTML = `
        <input type="file" id="pdf2wordInput" accept=".pdf">
        <br>
        <button onclick="convertPDFtoWord()" class="btn-main">Converter para Word</button>
        <p id="wordStatus"></p>
      `;
    }
  }

  // üìù Word ‚Üí PDF
  async function convertWord() {
    const input = document.getElementById("wordInput");
    const status = document.getElementById("wordStatus");

    if (!input.files.length) {
      status.textContent = "Por favor, seleciona um ficheiro .docx.";
      return;
    }

    const file = input.files[0];
    if (!file.name.endsWith(".docx")) {
      status.textContent = "Apenas ficheiros .docx s√£o suportados neste momento.";
      return;
    }

    status.textContent = "üì• A processar ficheiro...";

    const reader = new FileReader();
    reader.onload = async function (event) {
      const arrayBuffer = event.target.result;

      try {
        const result = await mammoth.convertToHtml({ arrayBuffer });
        const html = result.value;

        const doc = new jspdf.jsPDF();
        const text = html.replace(/<[^>]+>/g, "");
        const lines = doc.splitTextToSize(text, 180);
        let y = 20;

        for (let line of lines) {
          if (y > 270) {
            doc.addPage();
            y = 20;
          }
          doc.text(line, 15, y);
          y += 8;
        }

        doc.save("ficheiro_convertido.pdf");
        status.textContent = "‚úÖ Convers√£o conclu√≠da com sucesso!";
      } catch (e) {
        console.error(e);
        status.textContent = "‚ö†Ô∏è Erro ao converter o ficheiro.";
      }
    };

    reader.readAsArrayBuffer(file);
  }

  // üìÑ PDF ‚Üí Texto
  async function convertPDFtoText() {
    const input = document.getElementById("pdfInput");
    const status = document.getElementById("wordStatus");

    if (!input.files.length) {
      status.textContent = "Por favor, seleciona um ficheiro .pdf.";
      return;
    }

    status.textContent = "üì• A processar ficheiro...";

    const file = input.files[0];
    const reader = new FileReader();

    reader.onload = function () {
      const typedarray = new Uint8Array(reader.result);

      pdfjsLib.getDocument({ data: typedarray }).promise.then(function (pdf) {
        let textContent = "";

        const totalPages = pdf.numPages;
        let pagesProcessed = 0;

        for (let i = 1; i <= totalPages; i++) {
          pdf.getPage(i).then(function (page) {
            page.getTextContent().then(function (content) {
              const strings = content.items.map(item => item.str).join(" ");
              textContent += strings + "\n\n";
              pagesProcessed++;

              if (pagesProcessed === totalPages) {
                const blob = new Blob([textContent], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = "ficheiro_extraido.txt";
                a.click();
                URL.revokeObjectURL(url);
                status.textContent = "‚úÖ Texto extra√≠do com sucesso!";
              }
            });
          });
        }
      });
    };

    reader.readAsArrayBuffer(file);
  }

  // üñºÔ∏è Imagem ‚Üí PDF
  async function convertImageToPDF() {
    const input = document.getElementById("imgInput");
    const status = document.getElementById("wordStatus");

    if (!input.files.length) {
      status.textContent = "Por favor, seleciona uma imagem.";
      return;
    }

    status.textContent = "üì∑ A gerar PDF...";

    const file = input.files[0];
    const reader = new FileReader();

    reader.onload = function () {
      const img = new Image();
      img.src = reader.result;

      img.onload = function () {
        const doc = new jspdf.jsPDF({
          orientation: img.width > img.height ? 'l' : 'p',
          unit: 'px',
          format: [img.width, img.height]
        });

        doc.addImage(img, 'JPEG', 0, 0, img.width, img.height);
        doc.save("imagem_convertida.pdf");
        status.textContent = "‚úÖ PDF criado com sucesso!";
      };
    };

    reader.readAsDataURL(file);
  }

  // ‚ö†Ô∏è PDF ‚Üí Word (a definir mais tarde)
  function convertPDFtoWord() {
    const status = document.getElementById("wordStatus");
    status.textContent = "üöß Esta funcionalidade estar√° dispon√≠vel em breve!";
  }
</script>

</body>
</html>